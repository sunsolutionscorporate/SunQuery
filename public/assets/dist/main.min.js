!function(){try{if(!window.sunQuery)throw new Error("library 'sunQuery.js' belum terpasang");return async function(t){const e=console.log,n=document,a=function(e,n){if(!(e instanceof Element))throw new Error("[attach] 'target' must be a valid DOM element.");if("Dispatcher"===n?.constructor?.name){if("function"!=typeof n?.getContent)throw new Error("[attach] method 'getContent' not found on 'source' by 'Dispatcher'");n=n.getContent()}if(t.helper.type(n,"object")){if("function"!=typeof n?.toArray)throw new Error("[attach] method 'toArray' not found on 'source'");n=n.toArray()}return t.helper.type(n,"stringHtml")&&(n=t.helper.toHTML(n)),t.helper.type(n,"array")?(e.append(...n),!0):n instanceof Element?(e.append(n),!0):!!t.helper.type(n,"string")&&(e.textContent=n,!0)},o=function(...e){const n=new URL(t.app.host);return n.pathname=[n.pathname,...e].join("/").replace(/\/+/g,"/"),n.toString()},i=function(){};function r(e){if(!e?.host)throw new Error("[Kernel] Host not defined");e.host=e?.host?.replace(/^\/|\/$/g,"")+"/",this.version="1.0.0",this.UI=new i,this.host=e.host;const n=new s,a=this;a.utils={src:null,api_url:e?.api},q.config({observer:!0,formCostum:!0,router:!0,platform:!0,...e}),t.ready(async function(){r.background(),a.utils={...await t.getConfig(),...a.utils}}),this.request=async function(e,n){e=e.replace(/^\/|\/$/g,""),e=this.utils.host+"/"+e;try{return await t.ajax({url:e,...n})}catch(t){console.error(`Request Error: "${e}"`,t)}},this.view=function(t){n.define(t)}}i.prototype.component=new function(){this.section=function(){const e=t.createElement("section");return Object.defineProperty(e,"addHead",{value:function(e){let n=this.querySelector(".head");return n||(n=t.createElement("div",{class:"head"}),this.append(n),a(n,e)),this}}),Object.defineProperty(e,"addContent",{value:function(e){let n=this.querySelector(".body");return n||(n=t.createElement("div",{class:"body"}),this.append(n)),a(n,e),this}}),Object.defineProperty(e,"toArray",{value:function(){return[this]}}),e},this.card=function(){const e=t.createElement("div",{class:"card"});return Object.defineProperty(e,"addHead",{value:function(e){let n=this.querySelector(".head");return n||(n=t.createElement("h3",{class:"head"}),this.append(n)),a(n,e),this}}),Object.defineProperty(e,"addContent",{value:function(e){let n=this.querySelector(".body");return n||(n=t.createElement("div",{class:"body"}),this.append(n)),a(n,e),this}}),Object.defineProperty(e,"toArray",{value:function(){return[this]}}),e},this.chart=function(e){if(!e?.type)throw new Error("[chart] 'type' must be valid");if(!e?.data)throw new Error("[chart] 'data' must be valid");const n=t.createElement("canvas");return new Chart(n,{type:e.type,data:e.data,options:e?.options||{}}),Object.defineProperty(n,"toArray",{value:function(){return[this]}}),n},this.form=function(){}},r.background=function(){const t=q.createElement("canvas",{class:"bg-sky"});document.body.insertAdjacentElement("afterbegin",t);const e=q.createElement("div",{class:"background-earth-wrap",html:'<div class="earth"></div>'});q(t).append(e,"afterend");const n=t.getContext("2d"),a=function(){t.width=window.innerWidth,t.height=window.innerHeight};a();let o,i,r=[],s={x:-100,y:0,vx:0,vy:0,active:!1};for(let e=0;e<500;e++)r.push({x:Math.random()*t.width,y:Math.random()*t.height,radius:1.7*Math.random(),alpha:Math.random(),speed:.02*Math.random()+.005});function l(){n.clearRect(0,0,t.width,t.height),n.fillStyle="white",r.forEach(t=>{if(t.alpha+=t.speed*(Math.random()<.5?-1:1),t.alpha<.1&&(t.alpha=.1),t.alpha>1&&(t.alpha=1),null!==o&&null!==i){let e=t.x-o,n=t.y-i;if(Math.sqrt(e*e+n*n)<120){let a=Math.atan2(n,e);t.x+=.5*Math.cos(a),t.y+=.5*Math.sin(a)}}n.globalAlpha=t.alpha,n.beginPath(),n.arc(t.x,t.y,t.radius,0,2*Math.PI),n.fill()}),!s.active&&Math.random()<.002&&(s.x=Math.random()*t.width,s.y=0,s.vx=-4-2*Math.random(),s.vy=4+2*Math.random(),s.active=!0),s.active&&(n.globalAlpha=1,n.strokeStyle="#fff",n.lineWidth=2,n.beginPath(),n.moveTo(s.x,s.y),n.lineTo(s.x+10,s.y-10),n.stroke(),s.x+=s.vx,s.y+=s.vy,s.y>t.height&&(s.active=!1)),requestAnimationFrame(l)}l(),window.addEventListener("resize",a),window.addEventListener("mousemove",t=>{o=t.clientX,i=t.clientY})};const s=function(){this.version="1.0.0";const e={},o={head:null,main:null,foot:null};t.ready(()=>{o.head=n.querySelector("header"),o.main=n.querySelector("main"),o.foot=n.querySelector("footer"),Object.defineProperty(o.head,"update",{value:function(t){this.innerHTML="",a(this,t)}}),Object.defineProperty(o.main,"update",{value:function(t){this.innerHTML="",a(this,t)}}),Object.defineProperty(o.foot,"update",{value:function(t){this.innerHTML="",a(this,t)}})}),this.define=function(t){if("object"!=typeof t)throw new Error("[View] define 'pageView' must be a 'object'");for(const n in t)e[n]=t[n]},t.addEventListener("routes",async t=>{if(t.controller_name=t.controller_name.replace(/^\/|\/$/g,""),t.controller_name=t.controller_name||l.utils.defaultRouter||"web","function"!=typeof e[t.controller_name])throw new Error(`[View] Controller '${t.controller_name}' not found!`);t.host=l.host;const n=await e[t.controller_name](t);o.main.update(n),"Dispatcher"===n?.constructor?.name&&n.mount.call(o.main,t)})};s.dispatch=function(t,e){return new class{constructor(t,e){this.mount=e?.mount||function(){},this.getContent=function(){return t}}}(t,e)};const l=new r({host:"http://localhost/",defaultRouter:"dashboard"});t.extend(t,{app:l}),l.view({dashboard:function(e){let n="";for(let t=0;t<20;t++)n+='\n            <div class="item">\n               <div class="head">\n                  <i class="ph-fill ph-user-list"></i>\n               </div>\n               <div class="body">\n                  <div class="title">Residents</div>\n                  <div class="desc"> Kelola Data Penduduk desa dan luar desa agar supaya berguna</div>\n                  <div class="action-group">\n                     <a class="btn btn-primary" href="#/penduduk/">\n                        <i class="ph ph-book-open"></i>\n                        <span>Open</span>\n                     </a>\n                  </div>\n               </div>\n            </div>\n         ';const a=`\n         <section>\n            <div class="head">\n               <h1>Dashboard</h1>\n            </div>\n            <div class="body">\n               ${`\n      <div class="panel">\n         <div class="head">\n            <h3 class="panel-title">Panel title</h3>\n         </div>\n         <div class="body">\n            <p>Panel content</p>\n            ${n}\n         </div>\n      </div>\n      `}\n            </div>\n         </section>   \n      `;return s.dispatch(a,{mount(e){t.fontSize(e=>{const n=this.querySelector("section>.head").getBoundingClientRect().height,a=this.getBoundingClientRect().height;t(this).find("section").css("max-height",a-n+"px")})}})}}),l.view({login:function(){return xx='\n            <div class="login frm-sign" id="wasu">\n               <section>\n                  <div class="head">\n                     <h1>Sign in</h1>\n                  </div>\n                  <div class="body">\n                     <form action="">\n                        <div class="form-group">\n                           <label for="email">Email</label>\n                           <div class="input-group">\n                              <input type="text" name="email" id="email" />\n                           </div>\n                        </div>\n                        <div class="form-group">\n                           <label for="password">Password</label>\n                           <div class="input-group">\n                              <input type="password" name="password" id="password" />\n                           </div>\n                        </div>\n\n                        <div class="login-action">\n                           <a href="#">Forgot Password?</a>\n                           <button type="submit" class="btn btn-primary">Sign In</button>\n                           <span class="sparator">or</span>\n\n\n                           <button type="button" class="btn btn-google" id="googleLogin">\n                              <img src="http://localhost/assets/images/google.svg" alt="Google">\n                              <span>Continue with Google</span>\n                           </button>\n\n                     </form>\n                  </div>\n               </section>\n               <span>New to CBNLink? <a href="#">Join now</a></span>\n            </div>\n            ',s.dispatch(xx,{mount(a){t(".login form").on("submit",function(n){n.preventDefault(),t.ajax({url:o("login"),data:t(this).serialize(),method:"POST",success:t=>{e("SUCCESS",t)},error:t=>{e("ERROR",t)}})});const i=google.accounts.oauth2.initTokenClient({client_id:"598543379687-1o9bsasf8sialvhb0j8llndbhjgbgl6u.apps.googleusercontent.com",scope:"email profile",callback:a=>{t.loader({target:n.body,logo:o("assets/images/logo.png")}),t.ajax({url:o("api/google"),data:{access_token:a.access_token},method:"POST",success:n=>{e("GOOGLE",n),t.location("otp",{otp:n.data})},error:t=>{e("GOOGLE ERROR",t)},always:()=>{t(n.body).stopLoader()}})}});n.querySelector("#googleLogin")?.addEventListener("click",()=>{i.requestAccessToken()})}})}}),l.view({otp:function(){function a(t){return`\n         <p>Enter the OTP sent to your email ${t}. Keep this code private and never share it with anyone, even if they claim to be from us.</p>\n         <div class="form-otp">\n         <input type="text" maxlength="1" />\n         <input type="text" maxlength="1" />\n         <input type="text" maxlength="1" />\n         <input type="text" maxlength="1" />\n         <input type="text" maxlength="1" />\n         <input type="text" maxlength="1" />\n         </div>\n\n         <div class="login-action">\n         <button class="btn btn-primary">Verify</button>\n         <span>Code not received? <a class="btn-resend">Request again</a></span>\n      `}function i(t){return`\n         <p>The OTP code you entered has expired.  Please request a new code by pressing the 'Resend' button.  The new OTP will be sent to your email '${t}'.</p>\n\n         <div class="login-action">\n         <button type="button" class="btn btn-primary btn-resend">Resend</button>\n      `}return xx='\n            <div class="login frm-otp" id="wasu">\n               <section>\n                  <div class="head">\n                     <h1>OTP Verify</h1>\n                  </div>\n                  <div class="body">\n                     <form action="" class="otp">\n\n                     </form>\n                  </div>\n               </section>\n            </div>\n            ',s.dispatch(xx,{mount(r){let s=r.data?.otp,l=s?.token,d=s?.data;function c(t){const e=n.querySelector(t);e.innerHTML=a(d?.email||"");const o=e.querySelectorAll(".form-otp input");return o.forEach((t,e)=>{t.addEventListener("input",()=>{1===t.value.length&&e<o.length-1&&o[e+1].focus()}),t.addEventListener("keydown",n=>{"Backspace"===n.key&&""===t.value&&e>0&&o[e-1].focus()})}),o}s?t.storage.save("otp",{token:s.token,expires:s.expires,data:s.data}):(s=t.storage.load("otp"),l=s?.token,d=s?.data);let u=c(".login form");const p=function(){const a=Array.from(u).map(t=>t.value).join("");a.length<6?alert("Lengkapi semua digit OTP!"):(t.loader({target:n.body,logo:o("assets/images/logo.png")}),t.ajax({url:o("api/verify"),data:{token:l,code:a},method:"POST",success:e=>{t.storage.remove("otp"),t.storage.save("auth_session",e.data.token),location.hash=""},error:n=>{if("Expired verification code"===n.message){n.data;return t.storage.remove("otp"),t.storage.remove("auth_session"),void(this.innerHTML=i(d?.email||""))}e("ERROR",n)},always:()=>t(n.body).stopLoader()}))},h=function(){t.loader({target:n.body,logo:o("assets/images/logo.png")}),t.ajax({url:o("api/resend-otp"),data:d,method:"POST",success:e=>{s=e.data,l=s?.token,d=s?.data,t.storage.save("otp",{token:s.token,expires:s.expires,data:s.data}),u=c(".login form")},error:t=>{e("ERROR RESEND OTP",t)},always:()=>t(n.body).stopLoader()})};t(".login form.otp").on("submit",function(t){t.preventDefault(),e("SUBMIT"),p.call(this)}),t(".login form.otp").on("click",function(t){t.target.closest(".btn-resend")&&(t.preventDefault(),h.call(this))})}})}}),l.view({web:function(e){const n=[{head:"distribusi penduduk",type:"doughnut",data:{labels:["0-17 tahun","18-35 tahun","36-55 tahun","56+ tahun"],datasets:[{label:"Jumlah Penduduk",data:[3125,4375,3125,1875],backgroundColor:["#6366f1","#10b981","#f59e0b","#ef4444"],borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{color:"#a3a8ad",padding:20,usePointStyle:!0}}},scales:{y:{beginAtZero:!0,grid:{color:"rgba(255,255,255,0.1)"},ticks:{color:"#a3a8ad"}},x:{grid:{color:"rgba(255,255,255,0.1)"},ticks:{color:"#a3a8ad"}}}}},{head:"Anggaran Desa",type:"bar",data:{labels:["Pemasukan","Pengeluaran"],datasets:[{label:"Anggaran (Rp Juta)",data:[2500,2250],backgroundColor:["#10b981","#ef4444"],borderWidth:0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,grid:{color:"rgba(255,255,255,0.1)"},ticks:{color:"#a3a8ad"}},x:{grid:{color:"rgba(255,255,255,0.1)"},ticks:{color:"#a3a8ad"}}}}},{head:"Pajak PBB",type:"line",data:{labels:["2020","2021","2022","2023","2024"],datasets:[{label:"Pajak PBB (Rp Juta)",data:[50,55,60,58,62],borderColor:"#9b59b6",fill:!1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,grid:{color:"rgba(255,255,255,0.1)"},ticks:{color:"#a3a8ad"}},x:{grid:{color:"rgba(255,255,255,0.1)"},ticks:{color:"#a3a8ad"}}}}},{head:"Aparatur Desa",type:"bar",data:{labels:["Kepala Desa","Sekretaris","Kaur","Kadus","BPD"],datasets:[{label:"Jumlah Aparatur",data:[1,1,3,5,7],backgroundColor:"#34495e"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,grid:{color:"rgba(255,255,255,0.1)"},ticks:{color:"#a3a8ad"}},x:{grid:{color:"rgba(255,255,255,0.1)"},ticks:{color:"#a3a8ad"}}}}}],a=t.app.UI.component.section();return a.addHead('<h1 class="center">Data & Statistik Desa</h1>'),n.forEach(e=>{const n=t.app.UI.component.chart({type:e.type,data:e.data,options:e.options}),o=t.app.UI.component.card().addHead(e.head).addContent(n);a.addContent(o)}),a}})}(q)}catch(t){console.warn(t)}}();